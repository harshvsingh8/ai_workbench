
Create and activate venv. If the environment is messed up then do `rm -rf venv`.

Install the requirements.

#+begin_src 

source venv/bin/activate
pip install --upgrade pip
pip install -r requirements-base.txt

pip install torch --index-url https://download.pytorch.org/whl/cu121

pip install -r requirements-ml.txt

#+end_src

Register the venv for ipykernel.

#+begin_src 
python -m ipykernel install --user --name=venv --display-name "Python (ai_workbench-v/env)"
#+end_src

Do not freeze. 

Verify the install

#+begin_src 

import torch
print(torch.__version__)
print(torch.cuda.is_available())
print(torch.cuda.get_device_name(0))

from importlib.metadata import version
import tiktoken
print("tiktoken version:", version("tiktoken"))

#+end_src

We should see this

#+begin_src 
Python 3.10.12 (main, Aug 15 2025, 14:32:43) [GCC 11.4.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import torch
>>> print(torch.cuda.is_available())
True
>>> print(torch.cuda.get_device_name(0))
NVIDIA GeForce RTX 4050 Laptop GPU
>>>
#+end_src